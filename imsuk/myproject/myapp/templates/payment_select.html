{% extends 'base.html' %}
{% block title %}‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô - IMSUK{% endblock %}
{% load static %}
<img src="{% static 'images/qr_sample.jpg' %}" alt="QR Code" class="w-40 mx-auto my-4">

{% block content %}
<div class="max-w-lg mx-auto mt-20 bg-white bg-opacity-90 backdrop-blur-lg p-10 rounded-3xl shadow-2xl">
  <h1 class="text-3xl font-extrabold text-custom-darkgreen text-center mb-8">üßæ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h1>

  {% if messages %}
    <ul class="mb-4">
      {% for message in messages %}
        <li class="text-red-600">{{ message }}</li>
      {% endfor %}
    </ul>
  {% endif %}

  <form method="post" enctype="multipart/form-data" id="payment-form">
    {% csrf_token %}
    <div class="space-y-6 text-lg text-gray-700">
      <label class="flex items-center space-x-4">
        <input type="radio" name="method" value="cod" class="form-radio h-5 w-5 text-custom-darkgreen" required onchange="toggleQR(false)">
        <span>‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á (COD)</span>
      </label>
      <label class="flex items-center space-x-4">
        <input type="radio" name="method" value="credit" class="form-radio h-5 w-5 text-custom-darkgreen" required onchange="toggleQR(false)">
        <span>‡∏ö‡∏±‡∏ï‡∏£‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï/‡πÄ‡∏î‡∏ö‡∏¥‡∏ï</span>
      </label>
      <label class="flex items-center space-x-4">
        <input type="radio" name="method" value="qr" class="form-radio h-5 w-5 text-custom-darkgreen" required onchange="toggleQR(true)">
        <span>‡∏ä‡∏≥‡∏£‡∏∞‡∏ú‡πà‡∏≤‡∏ô QR Code</span>
      </label>
    </div>

    <!-- ‚úÖ ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á QR Code ‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ -->
    <div id="qr-section" class="hidden mt-6 space-y-4">
      <div class="text-center">
        <p class="text-lg font-semibold text-custom-darkgreen mb-2">‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô:</p>
        <img src="{% static 'images/qr_sample.jpg' %}" alt="QR Code" class="mx-auto w-40 h-40">
        <p class="text-base text-gray-700 mt-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô: <span class="text-custom-darkgreen font-bold">{{ total }} ‡∏ø</span></p>
      </div>

      <div>
        <label class="block text-base font-medium text-custom-darkgreen mb-1">‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô</label>
        <input type="file" name="slip" id="slip" accept="image/*" class="w-full border rounded px-4 py-2 bg-white">
      </div>
    </div>

    <button type="submit"
      class="w-full mt-6 py-4 bg-custom-darkgreen text-white rounded-xl shadow-md hover:bg-green-700 font-semibold text-lg transition">
      ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠
    </button>
  </form>
</div>

<script>
  function toggleQR(show) {
    document.getElementById('qr-section').classList.toggle('hidden', !show);
  }

  document.getElementById('payment-form').addEventListener('submit', function (e) {
    const selectedMethod = document.querySelector('input[name="method"]:checked').value;
    const slipInput = document.getElementById('slip');
    if (selectedMethod === 'qr' && (!slipInput || !slipInput.value)) {
      e.preventDefault();
      alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡πà‡∏≠‡∏ô‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠');
    }
  });
</script>
{% endblock %}
